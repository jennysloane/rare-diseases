---
title: "epidemiology"
output: html_document
date: '2023-03-01'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Goal - get the prevalence data unnested

```{r}
library(xml2)
library(tidyverse)

require(httr)

my_url <- "https://www.orphadata.com/data/xml/en_product9_prev.xml"
disease_xml <- as_list(read_xml(my_url))

data<-disease_xml$JDBOR

df = tibble::as_tibble(data) %>%
  unnest_wider(DisorderList) %>% 
  unnest(Name,OrphaCode,ExpertLink,DisorderType, DisorderGroup) %>% 
  unnest(DisorderType, DisorderGroup) %>% 
  unnest(PrevalenceList) %>% 
  unnest_wider(PrevalenceList) %>% 
  unnest(PrevalenceClass,PrevalenceType,PrevalenceQualification,PrevalenceGeographic,PrevalenceValidationStatus,ValMoy,Source) %>% 
  unnest(PrevalenceClass,PrevalenceType,PrevalenceQualification,PrevalenceGeographic,PrevalenceValidationStatus) %>% 
  select(-Availability) %>% 
  mutate_all(as.character)

ggplot(df,aes(x=PrevalenceClass))+
  geom_bar()

```


